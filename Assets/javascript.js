// Sidebar toggle (mobile)
const menuBtn = document.getElementById('menuBtn');
const sidebar = document.getElementById('sidebar');
const menuCloseBtns = document.querySelectorAll('.menuClose');

// Open / Toggle
menuBtn.addEventListener('click', () => {
  sidebar.classList.toggle('open');
});

// Close (for all close buttons)
menuCloseBtns.forEach(btn => {
  btn.addEventListener('click', () => {
    sidebar.classList.remove('open');
  });
});



    // Theme toggle with localStorage
    const themeBtn = document.getElementById('themeBtn');
    const themeLabel = document.getElementById('themeLabel');

    function setTheme(mode){
      document.documentElement.setAttribute('data-theme', mode);
      localStorage.setItem('theme', mode);
      themeLabel.textContent = (mode === 'dark') ? '‡¶≤‡¶æ‡¶á‡¶ü' : ' ‡¶°‡¶æ‡¶∞‡ßç‡¶ï ';
    }
    const saved = localStorage.getItem('theme');
    setTheme(saved || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'));

    themeBtn.addEventListener('click', ()=>{
      const current = document.documentElement.getAttribute('data-theme');
      setTheme(current === 'light' ? 'dark' : 'light');
    });


    // ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶ö‡¶≤‡¶æ   ###################################################

let runningFont = document.getElementById("runFont")
runningFont.innerText = " ‡¶∞‡¶æ‡¶¨‡ßç‡¶¨‡¶ø ‡¶ú‡¶ø‡¶¶‡¶®‡¶ø ‡¶á‡¶≤‡¶Æ‡¶æ üíé ‡¶∞‡¶æ‡¶¨‡ßç‡¶¨‡¶ø ‡¶ú‡¶ø‡¶¶‡¶®‡¶ø ‡¶á‡¶≤‡¶Æ‡¶æ üíé ‡¶∞‡¶æ‡¶¨‡ßç‡¶¨‡¶ø ‡¶ú‡¶ø‡¶¶‡¶®‡¶ø ‡¶á‡¶≤‡¶Æ‡¶æ üíé ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡¶á ‡¶Ø‡¶•‡ßá‡¶∑‡ßç‡¶ü : ‚Äò‡¶π‡¶æ‡¶∏‡¶¨‡ßÅ‡¶®‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡ßÅ ‡¶ì‡ßü‡¶æ ‡¶®‡¶ø‡¶Æ‡¶æ‡¶≤ ‡¶ì‡ßü‡¶æ‡¶ï‡¶ø‡¶≤, ‡¶®‡¶ø‡¶Æ‡¶æ‡¶≤ ‡¶Æ‡¶æ‡¶ì‡¶≤‡¶æ ‡¶ì‡ßü‡¶æ ‡¶®‡¶ø‡¶Æ‡¶æ‡¶® ‡¶®‡¶æ‡¶∏‡¶ø‡¶∞‡•§‚Äô üíé ";

// Accessible Accordion ###################################################
const headers = document.querySelectorAll('.accordion-header');

headers.forEach((btn) => {
  btn.addEventListener('click', () => togglePanel(btn));
  btn.addEventListener('keydown', (e) => {
    if(e.key === 'Enter' || e.key === ' '){ 
      e.preventDefault(); 
      togglePanel(btn); 
    }
  });
});

function togglePanel(btn){
  const expanded = btn.getAttribute('aria-expanded') === 'true';
  const panelId = btn.getAttribute('aria-controls');
  const panel = document.getElementById(panelId);

  // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ‡¶ü‡¶ø ‡¶ü‡¶ó‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®
  btn.setAttribute('aria-expanded', String(!expanded));
  panel.classList.toggle('open');

      // Smooth scroll into view when opened on mobile
      if(!expanded){
        setTimeout(()=>{ panel.scrollIntoView({behavior:'smooth', block:'nearest'}); }, 200);
      }
    }

// ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü  ###################################################

document.addEventListener("DOMContentLoaded", function() {
  const items = document.querySelectorAll(".dua-card");

  items.forEach(item => {
    const refDiv = item.querySelector(".ref");

    if (refDiv) {
      // ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶ï‡¶® ‡¶§‡ßà‡¶∞‡¶ø
      const shareIcon = document.createElement("i");
      shareIcon.className = "fa fa-share-alt";
      shareIcon.style.marginLeft = "8px";
      shareIcon.style.cursor = "pointer";
      shareIcon.setAttribute("title", "‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®");

      // ‡¶∞‡ßá‡¶´ div ‡¶è ‡¶¨‡¶∏‡¶æ‡¶®‡ßã
      refDiv.appendChild(shareIcon);

      // ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü
      shareIcon.addEventListener("click", async function() {
        // accordion-item ‡¶è‡¶∞ ‡¶≤‡ßá‡¶ñ‡¶æ‡¶ó‡ßÅ‡¶≤‡¶ø (HTML ‡¶¨‡¶æ‡¶¶ ‡¶¶‡¶ø‡ßü‡ßá, ‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßá‡¶á‡¶®‡¶ü‡ßá‡¶® ‡¶ï‡¶∞‡ßá)
        const textContent = item.innerText.trim();

        // ‡¶∏‡¶æ‡¶á‡¶ü ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶∂‡ßá‡¶∑‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ
        const shareText = `${textContent}\n\n‡¶Ü‡¶∞‡ßã ‡¶è‡¶Æ‡¶® ‡¶§‡¶•‡ßç‡¶Ø ‡¶ì ‡¶π‡¶æ‡¶¶‡¶ø‡¶∏ ‡¶™‡ßá‡¶§‡ßá ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®:\n${window.location.href}`;

        if (navigator.share) {
          try {
            await navigator.share({
              title: document.title,
              text: shareText
            });
          } catch (err) {
            console.log("‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤:", err);
          }
        } else {
          // fallback: ‡¶ï‡ßç‡¶≤‡¶ø‡¶™‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡ßü‡¶æ
          navigator.clipboard.writeText(shareText);
          alert("‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶®‡ßá‡¶á, ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶ï‡ßç‡¶≤‡¶ø‡¶™‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
        }
      });
    }
  });
});

   // idenhi ivdi balvisi likki 10 arba   ###################################################

var clickCount = 0;
var clickDiv = document.getElementById("clickDiv");
var hiddenDiv = document.getElementById("hdn");

if (!clickDiv || !hiddenDiv) {
  console.error("Could not find clickDiv or hiddenDiv");
} else {
  clickDiv.addEventListener("click", function() {
    clickCount++;
    if (clickCount === 5) {
      hiddenDiv.style.display = "block";
    }
  });
}

          //app shortcut          ###################################################
// Service Worker ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("../sw.js")
    .then(() => console.log("SW registered"))
    .catch(err => console.log("SW fail", err));
}


let deferredPrompt;
const installBtn = document.getElementById('installBtn');

// Install prompt event ‡¶ß‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;

  // ‡¶¨‡¶æ‡¶ü‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì
  installBtn.style.display = 'inline-block';
});

// ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá prompt ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
installBtn.addEventListener('click', () => {
  installBtn.style.display = 'none';
  deferredPrompt.prompt();

  deferredPrompt.userChoice.then((choiceResult) => {
    if (choiceResult.outcome === 'accepted') {
      console.log('‚úÖ User accepted install');
    } else {
      console.log('‚ùå User dismissed install');
    }
    deferredPrompt = null;
  });
});




// JavaScript code to create a dynamic Qibla compass inside #compasQ  ###################################################


// ‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶∏ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶®
const config = {
    size: 300,
    circleWidth: 10,
    colors: {
        background: '#f8f9fa',
        circle: '#343a40',
        needle: '#dc3545',
        north: '#dc3545',
        east: '#007bff',
        south: '#28a745',
        west: '#fd7e14',
        text: '#212529'
    }
};

// ‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶á‡¶®‡¶æ‡¶∞ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
const compasContainer = document.getElementById('compasQ');
compasContainer.style.display = 'flex';
compasContainer.style.flexDirection = 'column';
compasContainer.style.alignItems = 'center';
compasContainer.style.justifyContent = 'center';
compasContainer.style.padding = '20px';
compasContainer.style.fontFamily = 'Arial, sans-serif';

const canvas = document.createElement('canvas');
canvas.width = config.size;
canvas.height = config.size;
canvas.style.display = 'block';
canvas.style.margin = '0 auto';
canvas.style.borderRadius = '50%';
canvas.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.15)';
compasContainer.appendChild(canvas);

const ctx = canvas.getContext('2d');
const centerX = canvas.width / 2;
const centerY = canvas.height / 2;
const radius = (canvas.width / 2) - config.circleWidth;

let currentHeading = 0;

// ‡¶°‡¶ø‡¶ó‡ßç‡¶∞‡ßÄ ‡¶•‡ßá‡¶ï‡ßá ‡¶¶‡¶ø‡¶ï ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£
function getDirectionName(degrees) {
    const directions = ['‡¶â‡¶§‡ßç‡¶§‡¶∞', '‡¶â‡¶§‡ßç‡¶§‡¶∞-‡¶™‡ßÇ‡¶∞‡ßç‡¶¨', '‡¶™‡ßÇ‡¶∞‡ßç‡¶¨', '‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£-‡¶™‡ßÇ‡¶∞‡ßç‡¶¨', '‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£', '‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£-‡¶™‡¶∂‡ßç‡¶ö‡¶ø‡¶Æ', '‡¶™‡¶∂‡ßç‡¶ö‡¶ø‡¶Æ', '‡¶â‡¶§‡ßç‡¶§‡¶∞-‡¶™‡¶∂‡ßç‡¶ö‡¶ø‡¶Æ'];
    const index = Math.round(degrees / 45) % 8;
    return directions[index];
}

// ‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶∏ ‡¶Ü‡¶Å‡¶ï‡ßÅ‡¶®
function drawCompass(heading) {
    // ‡¶ï‡ßç‡¶Ø‡¶æ‡¶®‡¶≠‡¶æ‡¶∏ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // ‡¶¨‡¶æ‡¶á‡¶∞‡ßá‡¶∞ ‡¶¨‡ßÉ‡¶§‡ßç‡¶§ ‡¶Ü‡¶Å‡¶ï‡ßÅ‡¶®
    ctx.beginPath();
    ctx.arc(centerX, centerY, radius + config.circleWidth, 0, 2 * Math.PI);
    ctx.fillStyle = config.colors.background;
    ctx.fill();
    ctx.strokeStyle = config.colors.circle;
    ctx.lineWidth = config.circleWidth;
    ctx.stroke();
    
    // ‡¶Ö‡¶≠‡ßç‡¶Ø‡¶®‡ßç‡¶§‡¶∞‡ßÄ‡¶£ ‡¶¨‡ßÉ‡¶§‡ßç‡¶§ ‡¶Ü‡¶Å‡¶ï‡ßÅ‡¶®
    ctx.beginPath();
    ctx.arc(centerX, centerY, radius - 15, 0, 2 * Math.PI);
    ctx.strokeStyle = '#dee2e6';
    ctx.lineWidth = 1;
    ctx.stroke();
    
    // ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶¶‡¶ø‡¶ï‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂ (N, E, S, W) ‡¶Ü‡¶Å‡¶ï‡ßÅ‡¶®
    const mainDirections = [
        { text: 'N', angle: 0, color: config.colors.north },
        { text: 'E', angle: 90, color: config.colors.east },
        { text: 'S', angle: 180, color: config.colors.south },
        { text: 'W', angle: 270, color: config.colors.west }
    ];
    
    mainDirections.forEach(dir => {
        const angle = (dir.angle - heading) * Math.PI / 180;
        const x = centerX + Math.sin(angle) * (radius - 40);
        const y = centerY - Math.cos(angle) * (radius - 40);
        
        ctx.font = 'bold 24px Arial';
        ctx.fillStyle = dir.color;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(dir.text, x, y);
    });
    
    // ‡¶°‡¶ø‡¶ó‡ßç‡¶∞‡ßÄ ‡¶ö‡¶ø‡¶π‡ßç‡¶® ‡¶Ü‡¶Å‡¶ï‡ßÅ‡¶®
    for (let i = 0; i < 360; i += 30) {
        if (i % 90 === 0) continue; // Skip main directions
        
        const angle = (i - heading) * Math.PI / 180;
        const sin = Math.sin(angle);
        const cos = Math.cos(angle);
        
        // ‡¶ü‡¶ø‡¶ï ‡¶ö‡¶ø‡¶π‡ßç‡¶®
        ctx.beginPath();
        ctx.moveTo(centerX + sin * (radius - 20), centerY - cos * (radius - 20));
        ctx.lineTo(centerX + sin * radius, centerY - cos * radius);
        ctx.strokeStyle = config.colors.circle;
        ctx.lineWidth = 2;
        ctx.stroke();
        
        // ‡¶°‡¶ø‡¶ó‡ßç‡¶∞‡ßÄ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ
        const x = centerX + sin * (radius - 55);
        const y = centerY - cos * (radius - 55);
        
        ctx.font = '14px Arial';
        ctx.fillStyle = config.colors.text;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(i.toString(), x, y);
    }
    
    // ‡¶∏‡ßç‡¶•‡¶ø‡¶∞ ‡¶∏‡ßÅ‡¶á ‡¶Ü‡¶Å‡¶ï‡ßÅ‡¶® (‡¶∏‡¶∞‡ßç‡¶¨‡¶¶‡¶æ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂ ‡¶ï‡¶∞‡ßá)
    ctx.beginPath();
    ctx.moveTo(centerX, centerY - radius + 25);
    ctx.lineTo(centerX - 15, centerY);
    ctx.lineTo(centerX, centerY + 10);
    ctx.lineTo(centerX + 15, centerY);
    ctx.closePath();
    ctx.fillStyle = config.colors.needle;
    ctx.fill();
    
    // ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßÄ‡¶Ø‡¶º ‡¶¨‡¶ø‡¶®‡ßç‡¶¶‡ßÅ ‡¶Ü‡¶Å‡¶ï‡ßÅ‡¶®
    ctx.beginPath();
    ctx.arc(centerX, centerY, 8, 0, 2 * Math.PI);
    ctx.fillStyle = config.colors.circle;
    ctx.fill();
    
    ctx.beginPath();
    ctx.arc(centerX, centerY, 4, 0, 2 * Math.PI);
    ctx.fillStyle = '#fff';
    ctx.fill();
    
    // ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¶‡¶ø‡¶ï‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶®
    ctx.font = '16px Arial';
    ctx.fillStyle = config.colors.text;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(`‡¶¶‡¶ø‡¶ï: ${getDirectionName(heading)}`, centerX, centerY + 70);
    ctx.fillText(`‡¶°‡¶ø‡¶ó‡ßç‡¶∞‡ßÄ: ${Math.round(heading)}¬∞`, centerX, centerY + 95);
}

// ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶ì‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∂‡¶® ‡¶∂‡¶®‡¶æ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®
if (window.DeviceOrientationEvent) {
    window.addEventListener('deviceorientation', function(event) {
        // ‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶∏ ‡¶π‡ßá‡¶°‡¶ø‡¶Ç ‡¶®‡¶ø‡¶® (‡¶°‡¶ø‡¶ó‡ßç‡¶∞‡ßÄ‡¶§‡ßá)
        if (event.alpha !== null) {
            // iOS ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶ø‡¶õ‡ßÅ Android ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
            currentHeading = event.alpha;
        } else if (event.webkitCompassHeading !== undefined) {
            // iOS WebKit-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
            currentHeading = event.webkitCompassHeading;
        }
        
        // ‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        drawCompass(currentHeading);
    }, false);
} else {
    // ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶ì‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∂‡¶® ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ
    ctx.font = '18px Arial';
    ctx.fillStyle = config.colors.text;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶∏ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏‡ßá ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ', centerX, centerY);
}

// ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶∏ ‡¶Ü‡¶Å‡¶ï‡ßÅ‡¶®
drawCompass(currentHeading);

// ‡¶Ö‡¶®‡ßÅ‡¶Æ‡¶§‡¶ø ‡¶¨‡¶æ‡¶ü‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶® (iOS ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
    const permissionButton = document.createElement('button');
    permissionButton.textContent = '‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶∏ ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡¶§‡¶ø ‡¶¶‡¶ø‡¶®';
    permissionButton.style.marginTop = '20px';
    permissionButton.style.padding = '10px 20px';
    permissionButton.style.background = '#007bff';
    permissionButton.style.color = 'white';
    permissionButton.style.border = 'none';
    permissionButton.style.borderRadius = '5px';
    permissionButton.style.cursor = 'pointer';
    permissionButton.style.fontSize = '16px';
    
    permissionButton.onclick = function() {
        DeviceOrientationEvent.requestPermission()
            .then(response => {
                if (response === 'granted') {
                    permissionButton.style.display = 'none';
                    window.addEventListener('deviceorientation', function(event) {
                        if (event.webkitCompassHeading !== undefined) {
                            currentHeading = event.webkitCompassHeading;
                            drawCompass(currentHeading);
                        }
                    });
                }
            })
            .catch(error => {
                console.error('Compass permission error:', error);
            });
    };
    
    compasContainer.appendChild(permissionButton);
}
